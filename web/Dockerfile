# ğŸ³ Web å‰ç«¯ Dockerfile
# æ„å»º SolidJS åº”ç”¨å¹¶ä½¿ç”¨ nginx æä¾›é™æ€æ–‡ä»¶æœåŠ¡

# æ„å»ºé˜¶æ®µ
FROM node:18-alpine AS builder

WORKDIR /app

# å¤åˆ¶ package.json å’Œ package-lock.json
COPY package*.json ./

# å®‰è£…ä¾èµ–
RUN npm ci --only=production

# å¤åˆ¶æºä»£ç 
COPY . .

# æ„å»ºåº”ç”¨
RUN npm run build

# ç”Ÿäº§é˜¶æ®µ
FROM nginx:alpine

# å¤åˆ¶æ„å»ºäº§ç‰©
COPY --from=builder /app/dist /usr/share/nginx/html

# å¤åˆ¶ nginx é…ç½®
COPY nginx.conf /etc/nginx/nginx.conf

# æš´éœ²ç«¯å£
EXPOSE 3000

# å¯åŠ¨ nginx
CMD ["nginx", "-g", "daemon off;"] 